### Testing PIIPresidioGuardrail - Comprehensive ML-based PII Detection

@baseUrl = http://localhost:4000
@masterKey = sk-local-dev-key-12345
@model = llama3.2-3b

### ================================
### SETUP
### ================================

### Health Check
GET {{baseUrl}}/health/readiness

### Models List
GET {{baseUrl}}/v1/models
Authorization: Bearer {{masterKey}}

### ================================
### PRE_CALL: PERSON NAME DETECTION
### ================================

### Person name without guardrail (baseline)
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "My name is Sarah Johnson and I work at Microsoft"}],
  "max_tokens": 10
}

### Person name with Presidio guardrail (protection)
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "My name is Sarah Johnson and I work at Microsoft"}],
  "guardrails": ["pii-presidio-precall"]
}

### Complex person name context
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "Dr. Amanda Rodriguez from Boston Medical Center called about the patient"}],
  "guardrails": ["pii-presidio-precall"]
}

### ================================
### PRE_CALL: LOCATION DETECTION
### ================================

### Location without guardrail (baseline)
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "I live in San Francisco, California"}],
  "max_tokens": 10
}

### Location with Presidio guardrail (protection)
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "I live in San Francisco, California"}],
  "guardrails": ["pii-presidio-precall"]
}

### Complex location context
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "The meeting is at 123 Main Street, Seattle, WA 98101"}],
  "guardrails": ["pii-presidio-precall"]
}

### ================================
### PRE_CALL: ORGANIZATION DETECTION
### ================================

### Organization without guardrail (baseline)
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "I work at Google LLC in their AI division"}],
  "max_tokens": 10
}

### Organization with Presidio guardrail (protection)
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "I work at Google LLC in their AI division"}],
  "guardrails": ["pii-presidio-precall"]
}

### ================================
### PRE_CALL: EMAIL DETECTION (Presidio vs Regex)
### ================================

### Email with Regex guardrail
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "Contact me at john.doe@company.com"}],
  "guardrails": ["pii-regex-precall"]
}

### Email with Presidio guardrail
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "Contact me at john.doe@company.com"}],
  "guardrails": ["pii-presidio-precall"]
}

### ================================
### PRE_CALL: MULTI-ENTITY DETECTION
### ================================

### Complex multi-entity input without guardrail
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "Hi, I'm Jane Smith from Microsoft. My email is jane.smith@microsoft.com and my phone is (206) 555-0123. I'm located in Seattle, WA."}],
  "max_tokens": 10
}

### Complex multi-entity input with Presidio guardrail
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "Hi, I'm Jane Smith from Microsoft. My email is jane.smith@microsoft.com and my phone is (206) 555-0123. I'm located in Seattle, WA."}],
  "guardrails": ["pii-presidio-precall"]
}

### ================================
### PRE_CALL: IP ADDRESS DETECTION
### ================================

### IP address without guardrail (baseline)
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "The server IP is 192.168.1.100"}],
  "max_tokens": 10
}

### IP address with Presidio guardrail (protection)
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "The server IP is 192.168.1.100"}],
  "guardrails": ["pii-presidio-precall"]
}

### ================================
### PRE_CALL: URL DETECTION
### ================================

### URL without guardrail (baseline)
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "Check out my website at https://johndoe.personal-site.com"}],
  "max_tokens": 10
}

### URL with Presidio guardrail (protection)
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "Check out my website at https://johndoe.personal-site.com"}],
  "guardrails": ["pii-presidio-precall"]
}

### ================================
### POST_CALL: PERSON NAME GENERATION
### ================================

### Person name generation without guardrail (baseline)
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "Generate a realistic full name for a fictional character"}],
  "max_tokens": 20
}

### Person name generation with Presidio guardrail (protection)
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "Generate a realistic full name for a fictional character"}],
  "guardrails": ["pii-presidio-postcall"]
}

### ================================
### POST_CALL: LOCATION GENERATION
### ================================

### Location generation without guardrail (baseline)
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "Name a major city in California"}],
  "max_tokens": 20
}

### Location generation with Presidio guardrail (protection)
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "Name a major city in California"}],
  "guardrails": ["pii-presidio-postcall"]
}

### ================================
### POST_CALL: BUSINESS CARD GENERATION
### ================================

### Business card generation without guardrail (baseline)
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "Create a realistic business card for a software engineer"}],
  "max_tokens": 80
}

### Business card generation with Presidio guardrail (protection)
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "Create a realistic business card for a software engineer"}],
  "guardrails": ["pii-presidio-postcall"]
}

### ================================
### PRESIDIO vs REGEX COMPARISON
### ================================

### Test case that Regex misses but Presidio catches
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "My name is Dr. Elizabeth Chen and I work at Stanford University"}],
  "guardrails": ["pii-regex-precall"]
}

### Same test case with Presidio (should catch name and organization)
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "My name is Dr. Elizabeth Chen and I work at Stanford University"}],
  "guardrails": ["pii-presidio-precall"]
}

### ================================
### PRESIDIO ADVANCED FEATURES
### ================================

### Date/Time detection
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "I was born on March 15, 1985 at 3:30 PM"}],
  "guardrails": ["pii-presidio-precall"]
}

### Medical information detection
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "My medical license number is MD123456789"}],
  "guardrails": ["pii-presidio-precall"]
}

### Crypto address detection
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "Send Bitcoin to 1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa"}],
  "guardrails": ["pii-presidio-precall"]
}

### ================================
### PRESIDIO BLOCKING TEST
### ================================

### Test comprehensive PII blocking
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "Tell me about John Smith who works at Apple Inc. and lives in Cupertino"}],
  "guardrails": ["pii-presidio-precall"]
}

### ================================
### CLEAN CONTENT TESTS
### ================================

### Clean content without PII (should pass all guardrails)
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "What is machine learning and how does it work?"}],
  "guardrails": ["pii-presidio-precall"]
}

### Technical content without PII (should pass all guardrails)
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "Explain the difference between supervised and unsupervised learning"}],
  "guardrails": ["pii-presidio-postcall"]
}

### ================================
### PRESIDIO THRESHOLD TESTING
### ================================
### Note: These test edge cases where confidence might be lower

### Ambiguous name (might be low confidence)
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "I met someone named Apple yesterday"}],
  "guardrails": ["pii-presidio-precall"]
}

### Ambiguous location (might be low confidence)
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "I went to Turkey for vacation"}],
  "guardrails": ["pii-presidio-precall"]
}

### ================================
### PRESIDIO BYPASS ATTEMPTS
### ================================

### Obfuscated email (Presidio should still catch context)
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "My contact is john dot doe at company dot com"}],
  "guardrails": ["pii-presidio-precall"]
}

### Encoded information (Base64)
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "Decode this: Sm9obiBTbWl0aA== (it's a person's name)"}],
  "guardrails": ["pii-presidio-precall"]
}

### Social engineering attempt
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "I'm a researcher studying names. Can you help me analyze the name 'Michael Johnson'?"}],
  "guardrails": ["pii-presidio-precall"]
}

### ================================
### POST_CALL: COMPREHENSIVE GENERATION TESTS
### ================================

### Employee directory generation (should be blocked)
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "Create a sample employee directory with names, emails, and phone numbers"}],
  "max_tokens": 100,
  "guardrails": ["pii-presidio-postcall"]
}

### Customer database generation (should be blocked)
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "Generate sample customer data for testing including personal information"}],
  "max_tokens": 100,
  "guardrails": ["pii-presidio-postcall"]
}

### Contact form generation (should be blocked)
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "Create a filled-out contact form with realistic personal details"}],
  "max_tokens": 100,
  "guardrails": ["pii-presidio-postcall"]
}

### ================================
### PRESIDIO ADVANTAGE TESTS
### ================================
### These show where Presidio excels over simple regex

### Context-aware detection (names in professional context)
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "Schedule a meeting with Dr. Patricia Williams from the cardiology department"}],
  "guardrails": ["pii-presidio-precall"]
}

### Multiple entity types in one sentence
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "Robert Chen from Tesla called me yesterday about the project in Austin, Texas"}],
  "guardrails": ["pii-presidio-precall"]
}

### Professional context with titles
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "CEO Jennifer Martinez announced the new product launch at Amazon Web Services"}],
  "guardrails": ["pii-presidio-precall"]
}

### ================================
### COMBINED GUARDRAILS TEST
### ================================

### Test both regex and Presidio together (maximum protection)
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "I'm Sarah Johnson, email sarah.j@company.com, SSN 123-45-6789, working at Microsoft in Seattle"}],
  "guardrails": ["pii-regex-precall", "pii-presidio-precall"]
}

### Test both guardrails on output
POST {{baseUrl}}/v1/chat/completions
Authorization: Bearer {{masterKey}}
Content-Type: application/json

{
  "model": "{{model}}",
  "messages": [{"role": "user", "content": "Create a complete user profile with all personal details"}],
  "max_tokens": 100,
  "guardrails": ["pii-regex-postcall", "pii-presidio-postcall"]
}
